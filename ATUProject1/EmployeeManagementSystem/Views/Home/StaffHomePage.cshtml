@model StaffHomePageViewModel
@{
    ViewData["Title"] = "Staff Home Page";
}

<h2>Staff Home Page</h2>
<a asp-controller="Profile" asp-action="Contract" asp-route-id="@Model.UserProfileId">View Contract</a>

<!-- Calendar -->
<div id="calendar"></div>

<!-- Annual Leave -->
<div class="widget">
    <h3>Annual Leave</h3>
  <p>Days available: <span id="annualLeaveDays">@Model.AnnualLeaveDays</span></p>
  <button id="applyAnnualLeave">Apply for Annual Leave</button>
    <!-- Apply for Annual Leave modal -->
    <div class="modal fade" id="applyAnnualLeaveModal" tabindex="-1" role="dialog" aria-labelledby="applyAnnualLeaveModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="applyAnnualLeaveModalLabel">Apply for Annual Leave</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    @await Html.PartialAsync("_ApplyForLeave", new ApplyForLeaveViewModel { LeaveType = "Annual", UserProfileId = Model.UserProfileId.ToString() })
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Sick Leave -->
<div class="widget">
    <h3>Sick Leave</h3>
    <p>Days available: <span id="sickLeaveDays">@Model.SickLeaveDays</span></p>
    <button id="applySickLeave">Apply for Sick Leave</button>
    <!-- Apply for Sick Leave modal -->
    <div class="modal fade" id="applySickLeaveModal" tabindex="-1" role="dialog" aria-labelledby="applySickLeaveModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="applySickLeaveModalLabel">Apply for Sick Leave</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    @await Html.PartialAsync("_ApplyForLeave", new ApplyForLeaveViewModel { LeaveType = "Sick", UserProfileId = Model.UserProfileId.ToString() })
                </div>
            </div>
        </div>
    </div>
</div>
@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div class="alert alert-danger">
        @Model.ErrorMessage
    </div>
}
<!-- Other widgets -->

<script>
    $(document).ready(function () {
        // Initialize the calendar
        $('#calendar').fullCalendar({
            // Configure calendar options here
            events: @Html.Raw(Json.Serialize(Model.BankHolidays.Select(bh => new { title = "Bank Holiday", start = bh.Date.ToString("yyyy-MM-dd") })))
       });

        // Update available leave days
        $('#annualLeaveDays').text(/* Get available annual leave days from the server */);
        $('#sickLeaveDays').text(/* Get available sick leave days from the server */);

        // Open the "Apply for Annual Leave" modal when the button is clicked
        $('#applyAnnualLeave').click(function () {
            $('#applyAnnualLeaveModal').modal('show');
        });

        // Open the "Apply for Sick Leave" modal when the button is clicked
        $('#applySickLeave').click(function () {
            $('#applySickLeaveModal').modal('show');
        });
    });
</script>

<style>
    .widget {
        border: 1px solid #ccc;
        padding: 1rem;
        display: inline-block;
        margin-right: 1rem;
        vertical-align: top;
    }
</style>
